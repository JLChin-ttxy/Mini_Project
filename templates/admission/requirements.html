{% extends "base.html" %}

{% block title %}Admission Requirements - SKL Universiti{% endblock %}

{% block content %}
<section class="py-5">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        <h1 class="mb-4">Admission Requirements</h1>
        
        {% if program %}
        <!-- Program Information -->
        <div class="card shadow mb-4">
          <div class="card-body">
            <h2 class="card-title">{{ program.program_name }}</h2>
            <p class="text-muted">{{ program.faculty_name }} • {{ program.level }} • {{ program.duration_years }} Years</p>
            {% if program.description %}
            <p class="card-text">{{ program.description }}</p>
            {% endif %}
          </div>
        </div>

        <!-- Malaysian Student Requirements - UTAR Style -->
        {% if requirements %}
        <div class="card shadow mb-4">
          <div class="card-header bg-primary text-white">
            <h4 class="mb-0"><i class="bi bi-flag-fill"></i> Entry Requirements for Malaysian Students</h4>
            <small class="d-block mt-2">{% if program.level == 'Master' or program.level == 'PhD' %}Minimum qualification requirements{% else %}Choose any ONE of the following qualifications{% endif %}</small>
          </div>
          <div class="card-body p-0">
            <!-- Table format like UTAR website -->
            <div class="table-responsive">
              <table class="table table-hover mb-0">
                <thead class="table-light">
                  <tr>
                    <th style="width: 20%;" class="ps-4">Qualification</th>
                    <th style="width: 30%;">Minimum Grade/Requirement</th>
                    <th style="width: 40%;">Additional Requirements</th>
                    <th style="width: 10%;" class="text-center">Entrance Exam</th>
                  </tr>
                </thead>
                <tbody>
                  {% if program.level == 'Master' %}
                  <tr>
                    <td class="ps-4">
                      <strong class="text-primary">Bachelor's Degree or Equivalent</strong>
                      <br><small class="text-muted">Level 6 MQF or recognized professional degree</small>
                    </td>
                    <td>
                      {% set bachelor_req = requirements|selectattr('qualification_type', 'equalto', 'Bachelor')|first %}
                      {% if bachelor_req and bachelor_req.minimum_grade %}
                        <span class="text-success fw-semibold">{{ bachelor_req.minimum_grade }}</span>
                      {% else %}
                        <span class="text-success fw-semibold">Minimum CGPA 2.75</span>
                        <br><small class="text-muted">In relevant field (or equivalent)</small>
                      {% endif %}
                    </td>
                    <td>
                      {% if bachelor_req and bachelor_req.additional_requirements %}
                        <small>{{ bachelor_req.additional_requirements }}</small>
                      {% else %}
                        <small>Relevant field; may consider Level 6 MQF professional degree</small>
                      {% endif %}
                    </td>
                    <td class="text-center">
                      {% if bachelor_req and bachelor_req.entrance_exam_info and bachelor_req.entrance_exam_info != 'Not required' %}
                        <span class="badge bg-info">{{ bachelor_req.entrance_exam_info }}</span>
                      {% else %}
                        <span class="badge bg-success">Not Required</span>
                      {% endif %}
                    </td>
                  </tr>
                  <tr>
                    <td class="ps-4">
                      <strong class="text-primary">Recognized Professional Qualification</strong>
                      <br><small class="text-muted">MQA-recognized degree-equivalent</small>
                    </td>
                    <td>
                      <span class="text-success fw-semibold">Degree-equivalent</span>
                      <br><small class="text-muted">With sufficient standing</small>
                    </td>
                    <td>
                      <small>Typically with relevant work experience</small>
                    </td>
                    <td class="text-center">
                      <span class="badge bg-success">Not Required</span>
                    </td>
                  </tr>
                  {% elif program.level == 'PhD' %}
                  <tr>
                    <td class="ps-4">
                      <strong class="text-primary">Master's Degree or Equivalent</strong>
                      <br><small class="text-muted">Level 7 MQF or recognized professional Master</small>
                    </td>
                    <td>
                      {% set master_req = requirements|selectattr('qualification_type', 'equalto', 'Master')|first %}
                      {% if master_req and master_req.minimum_grade %}
                        <span class="text-success fw-semibold">{{ master_req.minimum_grade }}</span>
                      {% else %}
                        <span class="text-success fw-semibold">Minimum CGPA 3.00</span>
                        <br><small class="text-muted">In relevant field (or equivalent)</small>
                      {% endif %}
                    </td>
                    <td>
                      {% if master_req and master_req.additional_requirements %}
                        <small>{{ master_req.additional_requirements }}</small>
                      {% else %}
                        <small>Relevant field; research proposal/interview may apply</small>
                      {% endif %}
                    </td>
                    <td class="text-center">
                      {% if master_req and master_req.entrance_exam_info and master_req.entrance_exam_info != 'Not required' %}
                        <span class="badge bg-info">{{ master_req.entrance_exam_info }}</span>
                      {% else %}
                        <span class="badge bg-success">Not Required</span>
                      {% endif %}
                    </td>
                  </tr>
                  <tr>
                    <td class="ps-4">
                      <strong class="text-primary">Bachelor's Degree (First Class Honours)</strong>
                      <br><small class="text-muted">Direct PhD entry pathway</small>
                    </td>
                    <td>
                      <span class="text-success fw-semibold">Minimum CGPA 3.67</span>
                      <br><small class="text-muted">(First Class Honours)</small>
                    </td>
                    <td>
                      <small>Subject to research proposal & panel approval</small>
                    </td>
                    <td class="text-center">
                      <span class="badge bg-success">Not Required</span>
                    </td>
                  </tr>
                  {% else %}
                  {% set qualification_order = ['STPM', 'UEC', 'A-Level', 'Matriculation', 'Foundation', 'Diploma', 'SPM'] %}
                  {% for qual_type in qualification_order %}
                    {% set req = requirements|selectattr('qualification_type', 'equalto', qual_type)|first %}
                  <tr>
                    <td class="ps-4">
                      <strong class="text-primary">{{ qual_type }}</strong>
                      {% if qual_type == 'STPM' %}
                        <br><small class="text-muted">Sijil Tinggi Persekolahan Malaysia</small>
                      {% elif qual_type == 'UEC' %}
                        <br><small class="text-muted">Unified Examination Certificate</small>
                      {% elif qual_type == 'SPM' %}
                        <br><small class="text-muted">Sijil Pelajaran Malaysia</small>
                      {% elif qual_type == 'A-Level' %}
                        <br><small class="text-muted">GCE Advanced Level</small>
                      {% elif qual_type == 'Matriculation' %}
                        <br><small class="text-muted">Matriculation Certificate</small>
                      {% elif qual_type == 'Foundation' %}
                        <br><small class="text-muted">Foundation Studies</small>
                      {% elif qual_type == 'Diploma' %}
                        <br><small class="text-muted">Diploma (Level 4, MQF)</small>
                      {% endif %}
                    </td>
                    <td>
                      {% if qual_type == 'SPM' %}
                        {% if req and req.minimum_grade and ('Credit' in req.minimum_grade or 'credit' in req.minimum_grade) %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">5 Credits</span>
                          <br><small class="text-muted">(Credit = Grade C and above)</small>
                        {% endif %}
                      {% elif qual_type == 'UEC' %}
                        {% if req and req.minimum_grade and ('Bs' in req.minimum_grade or 'B' in req.minimum_grade or 'bs' in req.minimum_grade) %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">5 Bs</span>
                          <br><small class="text-muted">(Grade B = 60-69% or better)</small>
                        {% endif %}
                      {% elif qual_type == 'STPM' %}
                        {% if req and req.minimum_grade and ('CGPA' in req.minimum_grade or 'cgpa' in req.minimum_grade) %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">CGPA 2.00</span>
                          <br><small class="text-muted">(Minimum Cumulative Grade Point Average)</small>
                        {% endif %}
                      {% elif qual_type == 'Matriculation' %}
                        {% if req and req.minimum_grade %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">CGPA 2.00</span>
                          <br><small class="text-muted">(In relevant stream: Science/Arts)</small>
                        {% endif %}
                      {% elif qual_type == 'Foundation' %}
                        {% if req and req.minimum_grade %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">CGPA 2.00</span>
                          <br><small class="text-muted">(In relevant field)</small>
                        {% endif %}
                      {% elif qual_type == 'Diploma' %}
                        {% if req and req.minimum_grade %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">CGPA 2.50</span>
                          <br><small class="text-muted">(In relevant field, Level 4 MQF)</small>
                        {% endif %}
                      {% elif qual_type == 'A-Level' %}
                        {% if req and req.minimum_grade %}
                          <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                        {% else %}
                          <span class="text-success fw-semibold">2 Passes at Grade C</span>
                          <br><small class="text-muted">(GCE Advanced Level)</small>
                        {% endif %}
                      {% elif req and req.minimum_grade %}
                        <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                      {% else %}
                        <span class="text-muted">See additional requirements</span>
                      {% endif %}
                    </td>
                    <td>
                      {% if req and req.additional_requirements %}
                        <small>{{ req.additional_requirements }}</small>
                      {% else %}
                        {% if qual_type == 'SPM' %}
                          <small class="text-muted">Credit in relevant subjects (typically Mathematics and English)</small>
                        {% elif qual_type == 'UEC' %}
                          <small class="text-muted">Must include relevant subjects (typically Mathematics and English)</small>
                        {% elif qual_type == 'STPM' %}
                          <small class="text-muted">Pass in relevant subjects</small>
                        {% elif qual_type == 'Matriculation' %}
                          <small class="text-muted">In relevant stream (Science/Arts)</small>
                        {% elif qual_type == 'Foundation' %}
                          <small class="text-muted">In relevant field</small>
                        {% elif qual_type == 'Diploma' %}
                          <small class="text-muted">In relevant field</small>
                        {% else %}
                          <span class="text-muted">-</span>
                        {% endif %}
                      {% endif %}
                    </td>
                    <td class="text-center">
                      {% if req and req.entrance_exam_info and req.entrance_exam_info != 'Not required' %}
                        <span class="badge bg-info">{{ req.entrance_exam_info }}</span>
                      {% else %}
                        <span class="badge bg-success">Not Required</span>
                      {% endif %}
                    </td>
                  </tr>
                  {% endfor %}
                  
                  {# Show any other qualifications not in the standard list #}
                  {% for req in requirements %}
                    {% if req.qualification_type not in qualification_order %}
                  <tr>
                    <td class="ps-4">
                      <strong class="text-primary">{{ req.qualification_type }}</strong>
                    </td>
                    <td>
                      {% if req.minimum_grade %}
                        <span class="text-success fw-semibold">{{ req.minimum_grade }}</span>
                      {% else %}
                        <span class="text-muted">See additional requirements</span>
                      {% endif %}
                    </td>
                    <td>
                      {% if req.additional_requirements %}
                        <small>{{ req.additional_requirements }}</small>
                      {% else %}
                        <span class="text-muted">-</span>
                      {% endif %}
                    </td>
                    <td class="text-center">
                      {% if req.entrance_exam_info and req.entrance_exam_info != 'Not required' and req.entrance_exam_info %}
                        <span class="badge bg-info">{{ req.entrance_exam_info }}</span>
                      {% else %}
                        <span class="badge bg-success">Not Required</span>
                      {% endif %}
                    </td>
                  </tr>
                    {% endif %}
                  {% endfor %}
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
        {% else %}
        <div class="alert alert-warning">
          <h5>No specific requirements found</h5>
          <p>Please contact the admission office for detailed requirements for this program.</p>
        </div>
        {% endif %}

        <!-- International Student Requirements -->
        <div class="card shadow mt-4">
          <div class="card-header bg-info text-white">
            <h4 class="mb-0"><i class="bi bi-globe"></i> Requirements for International Students</h4>
          </div>
          <div class="card-body">
            <p class="lead">International students must meet additional academic and immigration requirements.</p>
            
            <h5 class="mt-3">Academic Qualification Equivalence</h5>
            <div class="table-responsive mb-3">
              <table class="table table-striped table-bordered">
                <thead class="table-light">
                  <tr>
                    <th style="width: 30%;">Qualification</th>
                    <th style="width: 35%;">Minimum Achievement</th>
                    <th style="width: 35%;">Notes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>A-Level / GCE</strong></td>
                    <td>At least 2 subjects at Grade C and above</td>
                    <td>Include required subjects (e.g., Math/Science) for the program</td>
                  </tr>
                  <tr>
                    <td><strong>International Baccalaureate (IB)</strong></td>
                    <td>Minimum 24 points</td>
                    <td>Preferably 2 Higher Level subjects relevant to the program</td>
                  </tr>
                  <tr>
                    <td><strong>Australian Year 12 / ATAR</strong></td>
                    <td>ATAR 60 or equivalent state-based TER/UEC</td>
                    <td>Subject prerequisites must be met</td>
                  </tr>
                  <tr>
                    <td><strong>Canadian Grade 12 / OSSD / CPU</strong></td>
                    <td>Average 65% in 6 best subjects</td>
                    <td>Include English and Mathematics where required</td>
                  </tr>
                  <tr>
                    <td><strong>US High School Diploma + SAT/ACT</strong></td>
                    <td>GPA 2.5 with SAT 1100 or ACT 22</td>
                    <td>AP/IB courses accepted for subject prerequisites</td>
                  </tr>
                  <tr>
                    <td><strong>International Foundation / Matriculation</strong></td>
                    <td>CGPA 2.50 (Level 4 MQF equivalent)</td>
                    <td>Program-relevant subjects must be passed</td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <h5 class="mt-4">1. Academic Requirements</h5>
            <ul>
              <li>Equivalent qualifications recognized by Malaysian Qualifications Agency (MQA)</li>
              <li>Minimum CGPA of 2.50 or equivalent in relevant field</li>
              <li>For Master's programs: Bachelor's degree with minimum CGPA 2.75</li>
              <li>For PhD programs: Master's degree with minimum CGPA 3.00</li>
            </ul>
            
            <h5 class="mt-4">2. English Language Proficiency</h5>
            <div class="table-responsive">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Test</th>
                    <th>Foundation/Diploma</th>
                    <th>Bachelor</th>
                    <th>Master/PhD</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>IELTS</strong></td>
                    <td>Band 5.0</td>
                    <td>Band 5.5</td>
                    <td>Band 6.0</td>
                  </tr>
                  <tr>
                    <td><strong>TOEFL</strong></td>
                    <td>500 (PBT) / 61 (iBT)</td>
                    <td>550 (PBT) / 79 (iBT)</td>
                    <td>580 (PBT) / 92 (iBT)</td>
                  </tr>
                  <tr>
                    <td><strong>MUET</strong></td>
                    <td>Band 3</td>
                    <td>Band 3</td>
                    <td>Band 4</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p class="text-muted small">
              <strong>Note:</strong> Students from English-speaking countries or those who completed their previous education in English may be exempted. Contact admission office for details.
            </p>
            
            <h5 class="mt-4">3. Visa and Immigration Requirements</h5>
            <ul>
              <li>Valid passport (minimum 18 months validity)</li>
              <li>Student Visa approval from Education Malaysia Global Services (EMGS)</li>
              <li>Medical examination report from recognized clinic</li>
              <li>Financial proof (bank statement showing sufficient funds)</li>
              <li>No-objection certificate (if applicable)</li>
            </ul>
            
            <h5 class="mt-4">4. Additional Documents</h5>
            <ul>
              <li>Certified copies of academic transcripts and certificates</li>
              <li>Certified English translations (if original documents are not in English)</li>
              <li>Two passport-sized photographs</li>
              <li>Medical fitness certificate</li>
              <li>Police clearance certificate (for some countries)</li>
            </ul>
            
            <div class="alert alert-warning mt-3">
              <strong>Important:</strong> International students must apply through EMGS. The university will assist with the visa application process after acceptance.
            </div>
            
            <div class="mt-3">
              <a href="{{ url_for('admission.document_checklist', program_id=program.program_id, country='International') }}" class="btn btn-outline-info">
                <i class="bi bi-file-earmark-text"></i> Get International Student Document Checklist
              </a>
            </div>
          </div>
        </div>

        <div class="mt-4 d-flex gap-3">
          <a href="{{ url_for('admission.check_eligibility') }}?program_id={{ program.program_id }}" class="btn btn-primary">
            <i class="bi bi-check-circle"></i> Check My Eligibility
          </a>
          <a href="{{ url_for('admission.document_checklist', program_id=program.program_id) }}" class="btn btn-outline-primary">
            <i class="bi bi-file-earmark-text"></i> Get Document Checklist
          </a>
          <a href="{{ url_for('admission.requirements') }}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Back to All Programs
          </a>
        </div>

        {% else %}
        <!-- All Programs List -->
        <div class="card shadow">
          <div class="card-body">
            <h3 class="mb-4">Select a Program to View Requirements</h3>
            <div class="list-group">
              {% for program in programs %}
              <a href="{{ url_for('admission.requirements', program_id=program.program_id) }}" 
                 class="list-group-item list-group-item-action">
                <div class="d-flex w-100 justify-content-between">
                  <h5 class="mb-1">{{ program.program_name }}</h5>
                  <small class="text-muted">{{ program.level }}</small>
                </div>
                <p class="mb-1 text-muted">{{ program.faculty_name }}</p>
              </a>
              {% endfor %}
            </div>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}


